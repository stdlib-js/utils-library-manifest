// Copyright (c) 2022 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./mod.d.ts" />
function e(e){if(e.__esModule)return e;var r=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var t=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,t.get?t:{enumerable:!0,get:function(){return e[n]}})})),r}function r(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function n(e,r){for(var n=0,t=e.length-1;t>=0;t--){var i=e[t];"."===i?e.splice(t,1):".."===i?(e.splice(t,1),n++):n&&(e.splice(t,1),n--)}if(r)for(;n--;n)e.unshift("..");return e}var t=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return t.exec(e).slice(1)};function o(){for(var e="",r=!1,t=arguments.length-1;t>=-1&&!r;t--){var i=t>=0?arguments[t]:"/";if("string"!=typeof i)throw new TypeError("Arguments to path.resolve must be strings");i&&(e=i+"/"+e,r="/"===i.charAt(0))}return(r?"/":"")+(e=n(d(e.split("/"),(function(e){return!!e})),!r).join("/"))||"."}function a(e){var r=u(e),t="/"===g(e,-1);return(e=n(d(e.split("/"),(function(e){return!!e})),!r).join("/"))||r||(e="."),e&&t&&(e+="/"),(r?"/":"")+e}function u(e){return"/"===e.charAt(0)}function l(){var e=Array.prototype.slice.call(arguments,0);return a(d(e,(function(e,r){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))}function c(e,r){function n(e){for(var r=0;r<e.length&&""===e[r];r++);for(var n=e.length-1;n>=0&&""===e[n];n--);return r>n?[]:e.slice(r,n-r+1)}e=o(e).substr(1),r=o(r).substr(1);for(var t=n(e.split("/")),i=n(r.split("/")),a=Math.min(t.length,i.length),u=a,l=0;l<a;l++)if(t[l]!==i[l]){u=l;break}var c=[];for(l=u;l<t.length;l++)c.push("..");return(c=c.concat(i.slice(u))).join("/")}function f(e){var r=i(e),n=r[0],t=r[1];return n||t?(t&&(t=t.substr(0,t.length-1)),n+t):"."}function s(e,r){var n=i(e)[2];return r&&n.substr(-1*r.length)===r&&(n=n.substr(0,n.length-r.length)),n}function p(e){return i(e)[3]}var v={extname:p,basename:s,dirname:f,sep:"/",delimiter:":",relative:c,join:l,isAbsolute:u,normalize:a,resolve:o};function d(e,r){if(e.filter)return e.filter(r);for(var n=[],t=0;t<e.length;t++)r(e[t],t,e)&&n.push(e[t]);return n}var g="b"==="ab".substr(-1)?function(e,r,n){return e.substr(r,n)}:function(e,r,n){return r<0&&(r=e.length+r),e.substr(r,n)},m=e(Object.freeze({__proto__:null,resolve:o,normalize:a,isAbsolute:u,join:l,relative:c,sep:"/",delimiter:":",dirname:f,basename:s,extname:p,default:v})),y="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function h(){throw new Error("setTimeout has not been defined")}function b(){throw new Error("clearTimeout has not been defined")}var w=h,j=b;function _(e){if(w===setTimeout)return setTimeout(e,0);if((w===h||!w)&&setTimeout)return w=setTimeout,setTimeout(e,0);try{return w(e,0)}catch(r){try{return w.call(null,e,0)}catch(r){return w.call(this,e,0)}}}"function"==typeof y.setTimeout&&(w=setTimeout),"function"==typeof y.clearTimeout&&(j=clearTimeout);var O,E=[],T=!1,S=-1;function k(){T&&O&&(T=!1,O.length?E=O.concat(E):S=-1,E.length&&N())}function N(){if(!T){var e=_(k);T=!0;for(var r=E.length;r;){for(O=E,E=[];++S<r;)O&&O[S].run();S=-1,r=E.length}O=null,T=!1,function(e){if(j===clearTimeout)return clearTimeout(e);if((j===b||!j)&&clearTimeout)return j=clearTimeout,clearTimeout(e);try{j(e)}catch(r){try{return j.call(null,e)}catch(r){return j.call(this,e)}}}(e)}}function x(e){var r=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)r[n-1]=arguments[n];E.push(new P(e,r)),1!==E.length||T||_(N)}function P(e,r){this.fun=e,this.array=r}P.prototype.run=function(){this.fun.apply(null,this.array)};var F={},A=[],q={},D={},I={};function V(){}var M=V,z=V,R=V,C=V,J=V,L=V,$=V;function G(e){throw new Error("process.binding is not supported")}function U(){return"/"}function B(e){throw new Error("process.chdir is not supported")}function X(){return 0}var Z=y.performance||{},K=Z.now||Z.mozNow||Z.msNow||Z.oNow||Z.webkitNow||function(){return(new Date).getTime()};function W(e){var r=.001*K.call(Z),n=Math.floor(r),t=Math.floor(r%1*1e9);return e&&(n-=e[0],(t-=e[1])<0&&(n--,t+=1e9)),[n,t]}var H=new Date;function Q(){return(new Date-H)/1e3}var Y={nextTick:x,title:"browser",browser:true,env:F,argv:A,version:"",versions:q,on:M,addListener:z,once:R,off:C,removeListener:J,removeAllListeners:L,emit:$,binding:G,cwd:U,chdir:B,umask:X,hrtime:W,platform:"browser",release:D,config:I,uptime:Q},ee=e(Object.freeze({__proto__:null,addListener:z,argv:A,binding:G,browser:true,chdir:B,config:I,cwd:U,default:Y,emit:$,env:F,hrtime:W,nextTick:x,off:C,on:M,once:R,platform:"browser",release:D,removeAllListeners:L,removeListener:J,title:"browser",umask:X,uptime:Q,version:"",versions:q}));void 0!==Y&&"renderer"===Y.type?module.exports=require("./browser.js"):module.exports=require("./node.js");var re=e(Object.freeze({__proto__:null})),ne=require("fs"),te=require("./homedir"),ie=require("path"),oe=require("./caller"),ae=require("./node-modules-paths"),ue=require("./normalize-options"),le=require("is-core-module"),ce=ne.realpath&&"function"==typeof ne.realpath.native?ne.realpath.native:ne.realpath,fe=te(),se=function(e,r){ne.stat(e,(function(e,n){return e?"ENOENT"===e.code||"ENOTDIR"===e.code?r(null,!1):r(e):r(null,n.isFile()||n.isFIFO())}))},pe=function(e,r){ne.stat(e,(function(e,n){return e?"ENOENT"===e.code||"ENOTDIR"===e.code?r(null,!1):r(e):r(null,n.isDirectory())}))},ve=function(e,r){ce(e,(function(n,t){n&&"ENOENT"!==n.code?r(n):r(null,n?e:t)}))},de=function(e,r,n,t){n&&!1===n.preserveSymlinks?e(r,t):t(null,r)},ge=function(e,r,n){e(r,(function(e,r){if(e)n(e);else try{var t=JSON.parse(r);n(null,t)}catch(e){n(null)}}))};module.exports=function(e,r,n){var t=n,i=r;if("function"==typeof r&&(t=i,i={}),"string"!=typeof e){var o=new TypeError("Path must be a string.");return Y.nextTick((function(){t(o)}))}var a=(i=ue(e,i)).isFile||se,u=i.isDirectory||pe,l=i.readFile||ne.readFile,c=i.realpath||ve,f=i.readPackage||ge;if(i.readFile&&i.readPackage){var s=new TypeError("`readFile` and `readPackage` are mutually exclusive.");return Y.nextTick((function(){t(s)}))}var p=i.packageIterator,v=i.extensions||[".js"],d=!1!==i.includeCoreModules,g=i.basedir||ie.dirname(oe()),m=i.filename||g;i.paths=i.paths||[ie.join(fe,".node_modules"),ie.join(fe,".node_libraries")];var y,h=ie.resolve(g);function b(r,n,o){r?t(r):n?t(null,n,o):_(y,(function(r,n,o){if(r)t(r);else if(n)de(c,n,i,(function(e,r){e?t(e):t(null,r,o)}));else{var a=new Error("Cannot find module '"+e+"' from '"+m+"'");a.code="MODULE_NOT_FOUND",t(a)}}))}function w(e,r,n){var t=r,o=n;"function"==typeof t&&(o=t,t=void 0),function e(r,n,t){if(0===r.length)return o(null,void 0,t);var u=n+r[0],l=t;l?c(null,l):j(ie.dirname(u),c);function c(t,c,s){if(l=c,t)return o(t);if(s&&l&&i.pathFilter){var p=ie.relative(s,u),d=p.slice(0,p.length-r[0].length),g=i.pathFilter(l,n,d);if(g)return e([""].concat(v.slice()),ie.resolve(s,g),l)}a(u,f)}function f(t,i){return t?o(t):i?o(null,u,l):void e(r.slice(1),n,l)}}([""].concat(v),e,t)}function j(e,r){return""===e||"/"===e||"win32"===Y.platform&&/^\w:[/\\]*$/.test(e)||/[/\\]node_modules[/\\]*$/.test(e)?r(null):void de(c,e,i,(function(n,t){if(n)return j(ie.dirname(e),r);var o=ie.join(t,"package.json");a(o,(function(n,t){if(!t)return j(ie.dirname(e),r);f(l,o,(function(n,t){n&&r(n);var a=t;a&&i.packageFilter&&(a=i.packageFilter(a,o)),r(null,a,e)}))}))}))}function _(e,r,n){var t=n,o=r;"function"==typeof o&&(t=o,o=i.package),de(c,e,i,(function(r,n){if(r)return t(r);var u=ie.join(n,"package.json");a(u,(function(r,n){return r?t(r):n?void f(l,u,(function(r,n){if(r)return t(r);var o=n;if(o&&i.packageFilter&&(o=i.packageFilter(o,u)),o&&o.main){if("string"!=typeof o.main){var a=new TypeError("package “"+o.name+"” `main` must be a string");return a.code="INVALID_PACKAGE_MAIN",t(a)}return"."!==o.main&&"./"!==o.main||(o.main="index"),void w(ie.resolve(e,o.main),o,(function(r,n,i){return r?t(r):n?t(null,n,i):i?void _(ie.resolve(e,i.main),i,(function(r,n,i){return r?t(r):n?t(null,n,i):void w(ie.join(e,"index"),i,t)})):w(ie.join(e,"index"),i,t)}))}w(ie.join(e,"/index"),o,t)})):w(ie.join(e,"index"),o,t)}))}))}function O(e,r){if(0===r.length)return e(null,void 0);var n=r[0];function t(r,t,a){return r?e(r):t?e(null,t,a):void _(n,i.package,o)}function o(n,t,i){return n?e(n):t?e(null,t,i):void O(e,r.slice(1))}u(ie.dirname(n),(function(o,a){if(o)return e(o);if(!a)return O(e,r.slice(1));w(n,i.package,t)}))}de(c,h,i,(function(r,n){r?t(r):function(r){if(/^(?:\.\.?(?:\/|$)|\/|([A-Za-z]:)?[/\\])/.test(e))y=ie.resolve(r,e),"."!==e&&".."!==e&&"/"!==e.slice(-1)||(y+="/"),/\/$/.test(e)&&y===r?_(y,i.package,b):w(y,i.package,b);else{if(d&&le(e))return t(null,e);!function(e,r,n){var t=function(){return function(e,r,n){for(var t=ae(r,n,e),i=0;i<t.length;i++)t[i]=ie.join(t[i],e);return t}(e,r,i)};O(n,p?p(e,r,t,i):t())}(e,r,(function(r,n,o){if(r)t(r);else{if(n)return de(c,n,i,(function(e,r){e?t(e):t(null,r,o)}));var a=new Error("Cannot find module '"+e+"' from '"+m+"'");a.code="MODULE_NOT_FOUND",t(a)}}))}}(n)}))};var me=e(Object.freeze({__proto__:null})),ye=Y.versions&&Y.versions.node&&Y.versions.node.split(".")||[];function he(e){for(var r=e.split(" "),n=r.length>1?r[0]:"=",t=(r.length>1?r[1]:r[0]).split("."),i=0;i<3;++i){var o=parseInt(ye[i]||0,10),a=parseInt(t[i]||0,10);if(o!==a)return"<"===n?o<a:">="===n&&o>=a}return">="===n}function be(e){var r=e.split(/ ?&& ?/);if(0===r.length)return!1;for(var n=0;n<r.length;++n)if(!he(r[n]))return!1;return!0}function we(e){if("boolean"==typeof e)return e;if(e&&"object"==typeof e){for(var r=0;r<e.length;++r)if(be(e[r]))return!0;return!1}return be(e)}var je=require("./core.json"),_e={};for(var Oe in je)Object.prototype.hasOwnProperty.call(je,Oe)&&(_e[Oe]=we(je[Oe]));module.exports=_e;var Ee=e(Object.freeze({__proto__:null})),Te=require("has");function Se(e,r){for(var n=e.split("."),t=r.split(" "),i=t.length>1?t[0]:"=",o=(t.length>1?t[1]:t[0]).split("."),a=0;a<3;++a){var u=parseInt(n[a]||0,10),l=parseInt(o[a]||0,10);if(u!==l)return"<"===i?u<l:">="===i&&u>=l}return">="===i}function ke(e,r){var n=r.split(/ ?&& ?/);if(0===n.length)return!1;for(var t=0;t<n.length;++t)if(!Se(e,n[t]))return!1;return!0}var Ne=require("./core.json");module.exports=function(e,r){return Te(Ne,e)&&function(e,r){if("boolean"==typeof r)return r;var n=void 0===e?Y.versions&&Y.versions.node:e;if("string"!=typeof n)throw new TypeError(void 0===e?"Unable to determine current node version":"If provided, a valid node version is required");if(r&&"object"==typeof r){for(var t=0;t<r.length;++t)if(ke(n,r[t]))return!0;return!1}return ke(n,r)}(r,Ne[e])};var xe=e(Object.freeze({__proto__:null})),Pe=require("is-core-module"),Fe=require("fs"),Ae=require("path"),qe=require("./homedir"),De=require("./caller"),Ie=require("./node-modules-paths"),Ve=require("./normalize-options"),Me=Fe.realpathSync&&"function"==typeof Fe.realpathSync.native?Fe.realpathSync.native:Fe.realpathSync,ze=qe(),Re=function(e){try{var r=Fe.statSync(e,{throwIfNoEntry:!1})}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return!1;throw e}return!!r&&(r.isFile()||r.isFIFO())},Ce=function(e){try{var r=Fe.statSync(e,{throwIfNoEntry:!1})}catch(e){if(e&&("ENOENT"===e.code||"ENOTDIR"===e.code))return!1;throw e}return!!r&&r.isDirectory()},Je=function(e){try{return Me(e)}catch(e){if("ENOENT"!==e.code)throw e}return e},Le=function(e,r,n){return n&&!1===n.preserveSymlinks?e(r):r},$e=function(e,r){var n=e(r);try{return JSON.parse(n)}catch(e){}};module.exports=function(e,r){if("string"!=typeof e)throw new TypeError("Path must be a string.");var n=Ve(e,r),t=n.isFile||Re,i=n.readFileSync||Fe.readFileSync,o=n.isDirectory||Ce,a=n.realpathSync||Je,u=n.readPackageSync||$e;if(n.readFileSync&&n.readPackageSync)throw new TypeError("`readFileSync` and `readPackageSync` are mutually exclusive.");var l=n.packageIterator,c=n.extensions||[".js"],f=!1!==n.includeCoreModules,s=n.basedir||Ae.dirname(De()),p=n.filename||s;n.paths=n.paths||[Ae.join(ze,".node_modules"),Ae.join(ze,".node_libraries")];var v=Le(a,Ae.resolve(s),n);if(/^(?:\.\.?(?:\/|$)|\/|([A-Za-z]:)?[/\\])/.test(e)){var d=Ae.resolve(v,e);"."!==e&&".."!==e&&"/"!==e.slice(-1)||(d+="/");var g=h(d)||w(d);if(g)return Le(a,g,n)}else{if(f&&Pe(e))return e;var m=function(e,r){for(var t=function(){return function(e,r,n){for(var t=Ie(r,n,e),i=0;i<t.length;i++)t[i]=Ae.join(t[i],e);return t}(e,r,n)},i=l?l(e,r,t,n):t(),a=0;a<i.length;a++){var u=i[a];if(o(Ae.dirname(u))){var c=h(u);if(c)return c;var f=w(u);if(f)return f}}}(e,v);if(m)return Le(a,m,n)}var y=new Error("Cannot find module '"+e+"' from '"+p+"'");throw y.code="MODULE_NOT_FOUND",y;function h(e){var r=b(Ae.dirname(e));if(r&&r.dir&&r.pkg&&n.pathFilter){var i=Ae.relative(r.dir,e),o=n.pathFilter(r.pkg,e,i);o&&(e=Ae.resolve(r.dir,o))}if(t(e))return e;for(var a=0;a<c.length;a++){var u=e+c[a];if(t(u))return u}}function b(e){if(""!==e&&"/"!==e&&!("win32"===Y.platform&&/^\w:[/\\]*$/.test(e)||/[/\\]node_modules[/\\]*$/.test(e))){var r=Ae.join(Le(a,e,n),"package.json");if(!t(r))return b(Ae.dirname(e));var o=u(i,r);return o&&n.packageFilter&&(o=n.packageFilter(o,e)),{pkg:o,dir:e}}}function w(e){var r=Ae.join(Le(a,e,n),"/package.json");if(t(r)){try{var o=u(i,r)}catch(e){}if(o&&n.packageFilter&&(o=n.packageFilter(o,e)),o&&o.main){if("string"!=typeof o.main){var l=new TypeError("package “"+o.name+"” `main` must be a string");throw l.code="INVALID_PACKAGE_MAIN",l}"."!==o.main&&"./"!==o.main||(o.main="index");try{var c=h(Ae.resolve(e,o.main));if(c)return c;var f=w(Ae.resolve(e,o.main));if(f)return f}catch(e){}}}return h(Ae.join(e,"/index"))}};var Ge=e(Object.freeze({__proto__:null})),Ue=me;Ue.core=Ee,Ue.isCore=function(e){return xe(e)},Ue.sync=Ge;var Be=Ue,Xe="function"==typeof Object.defineProperty?Object.defineProperty:null;var Ze=function(){try{return Xe({},"x",{}),!0}catch(e){return!1}},Ke=Object.defineProperty,We=Object.prototype,He=We.toString,Qe=We.__defineGetter__,Ye=We.__defineSetter__,er=We.__lookupGetter__,rr=We.__lookupSetter__;var nr=function(e,r,n){var t,i,o,a;if("object"!=typeof e||null===e||"[object Array]"===He.call(e))throw new TypeError("invalid argument. First argument must be an object. Value: `"+e+"`.");if("object"!=typeof n||null===n||"[object Array]"===He.call(n))throw new TypeError("invalid argument. Property descriptor must be an object. Value: `"+n+"`.");if((i="value"in n)&&(er.call(e,r)||rr.call(e,r)?(t=e.__proto__,e.__proto__=We,delete e[r],e[r]=n.value,e.__proto__=t):e[r]=n.value),o="get"in n,a="set"in n,i&&(o||a))throw new Error("invalid argument. Cannot specify one or more accessors and a value or writable attribute in the property descriptor.");return o&&Qe&&Qe.call(e,r,n.get),a&&Ye&&Ye.call(e,r,n.set),e},tr=Ke,ir=nr,or=Ze()?tr:ir;var ar=function(e,r,n){or(e,r,{configurable:!1,enumerable:!1,writable:!1,value:n})},ur=ar;var lr=function(e){return"string"==typeof e};var cr=function(){return"function"==typeof Symbol&&"symbol"==typeof Symbol("foo")}();var fr=function(){return cr&&"symbol"==typeof Symbol.toStringTag},sr=Object.prototype.toString,pr=sr;var vr=function(e){return pr.call(e)},dr=Object.prototype.hasOwnProperty;var gr=function(e,r){return null!=e&&dr.call(e,r)},mr="function"==typeof Symbol?Symbol.toStringTag:"",yr=gr,hr=mr,br=sr;var wr=vr,jr=function(e){var r,n,t;if(null==e)return br.call(e);n=e[hr],r=yr(e,hr);try{e[hr]=void 0}catch(r){return br.call(e)}return t=br.call(e),r?e[hr]=n:delete e[hr],t},_r=fr()?jr:wr,Or=String.prototype.valueOf;var Er=_r,Tr=function(e){try{return Or.call(e),!0}catch(e){return!1}},Sr=fr();var kr=function(e){return"object"==typeof e&&(e instanceof String||(Sr?Tr(e):"[object String]"===Er(e)))},Nr=lr,xr=kr;var Pr=ur,Fr=function(e){return Nr(e)||xr(e)},Ar=kr;Pr(Fr,"isPrimitive",lr),Pr(Fr,"isObject",Ar);var qr=Fr,Dr=/./;var Ir=function(e){return"boolean"==typeof e},Vr=Boolean.prototype.toString;var Mr=_r,zr=function(e){try{return Vr.call(e),!0}catch(e){return!1}},Rr=fr();var Cr=function(e){return"object"==typeof e&&(e instanceof Boolean||(Rr?zr(e):"[object Boolean]"===Mr(e)))},Jr=Ir,Lr=Cr;var $r=ur,Gr=function(e){return Jr(e)||Lr(e)},Ur=Cr;$r(Gr,"isPrimitive",Ir),$r(Gr,"isObject",Ur);var Br=Gr;var Xr=function(){return new Function("return this;")()},Zr="object"==typeof self?self:null,Kr="object"==typeof window?window:null,Wr="object"==typeof y?y:null;module.exports=Wr;var Hr=Br.isPrimitive,Qr=Xr,Yr=Zr,en=Kr,rn=e(Object.freeze({__proto__:null}));var nn=function(e){if(arguments.length){if(!Hr(e))throw new TypeError("invalid argument. Must provide a boolean primitive. Value: `"+e+"`.");if(e)return Qr()}if(Yr)return Yr;if(en)return en;if(rn)return rn;throw new Error("unexpected error. Unable to resolve global object.")},tn=nn(),on=tn.document&&tn.document.childNodes,an=Int8Array,un=Dr,ln=on,cn=an;var fn=function(){return"function"==typeof un||"object"==typeof cn||"function"==typeof ln};var sn=function(){return/^\s*function\s*([^(]*)/i},pn=sn;ur(pn,"REGEXP",sn());var vn=pn,dn=_r;var gn=Array.isArray?Array.isArray:function(e){return"[object Array]"===dn(e)},mn=gn;var yn=function(e){return null!==e&&"object"==typeof e};ur(yn,"isObjectLikeArray",function(e){if("function"!=typeof e)throw new TypeError("invalid argument. Must provide a function. Value: `"+e+"`.");return function(r){var n,t;if(!mn(r))return!1;if(0===(n=r.length))return!1;for(t=0;t<n;t++)if(!1===e(r[t]))return!1;return!0}}(yn));var hn=yn;var bn=_r,wn=vn.REGEXP,jn=function(e){return hn(e)&&(e._isBuffer||e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e))};var _n=function(e){var r,n,t;if(("Object"===(n=bn(e).slice(8,-1))||"Error"===n)&&e.constructor){if("string"==typeof(t=e.constructor).name)return t.name;if(r=wn.exec(t.toString()))return r[1]}return jn(e)?"Buffer":n},On=_n;var En=_n;var Tn=function(e){var r;return null===e?"null":"object"===(r=typeof e)?On(e).toLowerCase():r},Sn=function(e){return En(e).toLowerCase()},kn=fn()?Sn:Tn;var Nn=function(e){return"function"===kn(e)},xn=ee;var Pn,Fn=function(){return xn.cwd()},An=e(Object.freeze({__proto__:null,default:{}})),qn=An;Pn="function"==typeof qn.access?qn.access:qn.stat;var Dn,In=function(e,r){Pn(e,(function(e){if(2===r.length)return e?r(e,!1):r(null,!0);if(e)return r(!1);return r(!0)}))},Vn=An;Dn="function"==typeof Vn.accessSync?Vn.accessSync:Vn.statSync;var Mn=function(e){try{Dn(e)}catch(e){return!1}return!0},zn=In;ur(zn,"sync",Mn);var Rn=zn,Cn=gn;var Jn=function(e){return"object"==typeof e&&null!==e&&!Cn(e)},Ln=Object.getPrototypeOf;var $n=function(e){return e.__proto__},Gn=_r,Un=$n;var Bn=function(e){var r=Un(e);return r||null===r?r:"[object Function]"===Gn(e.constructor)?e.constructor.prototype:e instanceof Object?Object.prototype:null},Xn=Ln,Zn=Bn,Kn=Nn(Object.getPrototypeOf)?Xn:Zn;var Wn=Jn,Hn=Nn,Qn=function(e){return null==e?null:(e=Object(e),Kn(e))},Yn=gr,et=_r,rt=Object.prototype;var nt=function(e){var r;return!!Wn(e)&&(!(r=Qn(e))||!Yn(e,"constructor")&&Yn(r,"constructor")&&Hn(r.constructor)&&"[object Function]"===et(r.constructor)&&Yn(r,"isPrototypeOf")&&Hn(r.isPrototypeOf)&&(r===rt||function(e){var r;for(r in e)if(!Yn(e,r))return!1;return!0}(e)))},tt=nt,it=gr,ot=qr.isPrimitive;var at=function(e,r){return tt(r)?it(r,"dir")&&(e.dir=r.dir,!ot(e.dir))?new TypeError("invalid option. `dir` option must be a primitive string. Option: `"+e.dir+"`."):null:new TypeError("invalid argument. Options argument must be an object. Value: `"+r+"`.")},ut=m.resolve,lt=qr.isPrimitive,ct=Nn,ft=Fn,st=Rn,pt=at;var vt=function(e,r,n){var t,i,o,a,u,l;if(!lt(e))throw new TypeError("invalid argument. First argument must be a string primitive. Value: `"+e+"`.");if(o={},arguments.length>2){if(a=n,l=pt(o,r))throw l}else a=r;if(!ct(a))throw new TypeError("invalid argument. Callback argument must be a function. Value: `"+a+"`.");function c(r,n){return n?a(null,t):(i=u,u=ut(u,".."),i===u?a(null,null):(t=ut(u,e),void st(t,c)))}u=o.dir?ut(ft(),o.dir):ft(),t=ut(u,e),st(t,c)},dt=m.resolve,gt=qr.isPrimitive,mt=Fn,yt=Rn.sync,ht=at;var bt=function(e,r){var n,t,i,o,a;if(!gt(e))throw new TypeError("invalid argument. First argument must be a string primitive. Value: `"+e+"`.");if(i={},arguments.length>1&&(a=ht(i,r)))throw a;for(o=i.dir?dt(mt(),i.dir):mt();t!==o;){if(n=dt(o,e),yt(n))return n;t=o,o=dt(o,"..")}return null},wt=vt;ur(wt,"sync",bt);var jt=wt;var _t=function(){return/^\\\\\?\\.+/},Ot=_t;ur(Ot,"REGEXP",_t());var Et=Ot,Tt=qr.isPrimitive;var St=function(e){if(!Tt(e))throw new TypeError("invalid argument. Must provide a primitive string. Value: `"+e+"`.");return e.toLowerCase()},kt=qr.isPrimitive,Nt=/[-\/\\^$*+?.()|[\]{}]/g;var xt=function(e){var r,n;if(!kt(e))throw new TypeError("invalid argument. Must provide a regular expression string. Value: `"+e+"`.");if("/"===e[0])for(n=e.length-1;n>=0&&"/"!==e[n];n--);return void 0===n||n<=0?e.replace(Nt,"\\$&"):(r=(r=e.substring(1,n)).replace(Nt,"\\$&"),e=e[0]+r+e.substring(n))},Pt=RegExp.prototype.exec;var Ft=_r,At=function(e){try{return Pt.call(e),!0}catch(e){return!1}},qt=fr();var Dt=xt,It=Nn,Vt=qr.isPrimitive,Mt=function(e){return"object"==typeof e&&(e instanceof RegExp||(qt?At(e):"[object RegExp]"===Ft(e)))};var zt=qr.isPrimitive,Rt=Et,Ct=St,Jt=function(e,r,n){if(!Vt(e))throw new TypeError("invalid argument. First argument must be a string primitive. Value: `"+e+"`.");if(Vt(r))r=Dt(r),r=new RegExp(r,"g");else if(!Mt(r))throw new TypeError("invalid argument. Second argument must be a string primitive or regular expression. Value: `"+r+"`.");if(!Vt(n)&&!It(n))throw new TypeError("invalid argument. Third argument must be a string primitive or replacement function. Value: `"+n+"`.");return e.replace(r,n)},Lt=/^([A-Za-z]):[\\\/]+/,$t=/^\/([A-Za-z])\//;var Gt=function(e,r){var n,t,i;if(!zt(e))throw new TypeError("invalid argument. First argument must be a string primitive. Value: `"+e+"`.");if(!zt(r))throw new TypeError("invalid argument. Second argument must be a string primitive. Value: `"+r+"`.");if("win32"!==r&&"mixed"!==r&&"posix"!==r)throw new Error("invalid argument. Second argument must be a recognized output path convention. Value: `"+r+"`.");if(i=e,"win32"===r)return(t=$t.exec(i))&&(n=t[1]+":\\",i=Jt(i,$t,n)),Jt(i,"/","\\");if(Rt.REGEXP.test(e))throw new Error("invalid argument. Cannot convert Windows extended-length paths to POSIX paths. Value: `"+e+"`.");return"mixed"===r?((t=$t.exec(i))?(n=t[1]+":/",i=Jt(i,$t,n)):(t=Lt.exec(i))&&(n=t[1]+":/",i=Jt(i,Lt,n)),Jt(i,"\\","/")):((t=Lt.exec(i))&&(n="/"+Ct(t[1])+"/",i=Jt(i,Lt,n)),Jt(i,"\\","/"))};var Ut=function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)},Bt=Object.keys;var Xt=function(e){var r,n;for(r={},n=0;n<e.length;n++)r[e[n]]=!0;return Bt(r)},Zt=Ut,Kt=Object.prototype.hasOwnProperty;var Wt=function(e,r){return Zt(r)?Kt.call(r,"basedir")&&(e.basedir=r.basedir,"string"!=typeof e.basedir)?new TypeError("invalid option. `basedir` option must be a primitive string. Option: `"+e.basedir+"`."):Kt.call(r,"paths")&&(e.paths=r.paths,"string"!=typeof e.paths)?new TypeError("invalid option. `paths` option must be a primitive string. Option: `"+e.paths+"`."):null:new TypeError("invalid argument. Options argument must be an object. Value: `"+r+"`.")},Ht={filename:"manifest.json",basedir:"",paths:""},Qt=m,Yt=ee.cwd,ei=re,ri=Be.sync,ni=jt.sync,ti=Gt,ii=Ut,oi=Xt,ai=Wt,ui=Ht,li=ei("library-manifest:main"),ci=Object.prototype.hasOwnProperty,fi=Object.keys;var si=function e(n,t,i){var o,a,u,l,c,f,s,p,v,d,g,m,y,h,b,w;if("string"!=typeof n)throw new TypeError("invalid argument. First argument must be a string. Value: `"+n+"`.");if(f=JSON.parse(JSON.stringify(ui)),arguments.length>2){if(g=ai(f,i))throw g;f.basedir=Qt.resolve(Yt(),f.basedir)}else f.basedir=Yt();if(li("Options: %s",JSON.stringify(f)),n=Qt.resolve(f.basedir,n),m=Qt.dirname(n),li("Manifest file path: %s",n),c=r(n),c=JSON.parse(JSON.stringify(c)),li("Manifest: %s",JSON.stringify(c)),!ii(t))throw new TypeError("invalid argument. Second argument must be an object. Value: `"+t+"`.");for(li("Provided conditions: %s",JSON.stringify(t)),o=fi(c.options),h=0;h<o.length;h++)v=o[h],ci.call(t,v)&&(c.options[v]=t[v]);for(li("Conditions for matching a configuration: %s",JSON.stringify(c.options)),li("Resolving matching configuration."),h=0;h<c.confs.length;h++){for(y=c.confs[h],b=0;b<o.length&&(v=o[b],ci.call(y,v)&&y[v]===c.options[v]);b++);if(b===o.length){p=JSON.parse(JSON.stringify(y)),li("Matching configuration: %s",JSON.stringify(p));break}}if(void 0===p)return li("Unable to resolve a matching configuration."),{};for(h=0;h<c.fields.length;h++)if(v=c.fields[h].field,ci.call(p,v)&&(y=p[v],c.fields[h].resolve))for(b=0;b<y.length;b++)y[b]=Qt.resolve(m,y[b]);for(s=p.dependencies,li("Resolving %d dependencies.",s.length),u={basedir:f.basedir},h=0;h<s.length;h++){for(li("Resolving dependency: %s",s[h]),a=ri(s[h],u),li("Dependency entry point: %s",a),a=ni("package.json",{dir:Qt.dirname(a)}),a=Qt.dirname(a),li("Dependency path: %s",a),l={basedir:a},y=e(Qt.join(a,f.filename),t,l),li("Dependency manifest: %s",JSON.stringify(y)),li("Merging dependency manifest."),b=0;b<c.fields.length;b++)if(v=c.fields[b].field,ci.call(y,v)){if(d=y[v],c.fields[b].resolve)for(w=0;w<d.length;w++)d[w]=Qt.resolve(a,d[w]);p[v]=p[v].concat(d)}li("Resolved dependency: %s",s[h])}for(li("Removing duplicate entries."),h=0;h<c.fields.length;h++)v=c.fields[h].field,ci.call(p,v)&&(p[v]=oi(p[v]));for(li("Generating relative paths."),h=0;h<c.fields.length;h++)if(v=c.fields[h].field,ci.call(p,v)&&c.fields[h].resolve&&c.fields[h].relative)for(d=p[v],b=0;b<d.length;b++)d[b]=Qt.relative(m,d[b]);if(f.paths)for(li("Converting paths to specified convention."),h=0;h<c.fields.length;h++)if(v=c.fields[h].field,ci.call(p,v))for(d=p[v],b=0;b<d.length;b++)d[b]=ti(d[b],f.paths);return li("Final configuration: %s",JSON.stringify(p)),p},pi=si;export{pi as default};
//# sourceMappingURL=mod.js.map
